from sympy import symbols, Eq, solve
from constants import l_1, l_2, l_3, l_4, m_1, m_2, m_3, m_4
from utils import printItem

just_eq = '''
(2m_1 +m_3)x_2010 =l_1x_1010 + l_3x_2000,
(l_1 +m_1 +m_3)x_1010 = 2m_1x_2010 +l_1x_0010 +m_3x_1000,
(l_1 +l_2 +m_3)x_0010 =m_1x_1010 +l_3x_0000 +m_2x_0110,
(m_2 +m_3)x_0110 =l_2x_0010 +l_3x_0100,
(m_4 +l_1)x_0001 =l_4x_0000 +m_1x_1001,
(l_1 +l_2 +l_3 +l_4)x_0000 =m_3x_0010 +m_4x_0001 +m_1x_1000 +m_2x_0100,
(m_2 +l_1 +l_2 +l_3)x_0100 =l_2x_0000 +m_1x_1100+2m_2x_0200 +m_3x_0110,
(2m_2 +l_1)x_0200 =l_2x_0100 +m_1x_1200,
(m_1 +m_4)x_1001 =l_1x_0001 +l_4x_1000,
(l_4 +l_1 +l_2 +m_1 +l_3)x_1000 =m_4x_1001+2m_1x_2000 +m_2x_1100 +l_1x_0000 +m_3x_1010,
(m_2 +l_1 +l_2 +m_1)x_1100 =l_2x_1000+2m_1x_2100+2m_2x_1200 +l_1x_0100,
(2m_2 +m_1)x_1200 =l_2x_1100 +l_1x_0200,
(l_3 +l_1 +l_2+2m_1)x_2000 =m_3x_2010+3m_1x_3000 +m_2x_2100 +l_1x_1000,
(m_2 +l_1+2m_1)x_2100 =l_2x_2000+3m_1x_3100 +l_1x_1100,
(l_1 +l_2+3m_1)x_3000 = 4m_1x_4000 +m_2x_3100 +l_1x_2000,
(m_2+3m_1)x_3100 =l_2x_3000 +l_1x_2100,
(l_1+4m_1)x_4000 = 5m_1x_5000 +l_1x_3000,
5m_1x_5000 =l_1x_4000,
x_2010 + x_1010 + x_0010 + x_0110 + x_0001 + x_0000 + x_0100 + x_0200 + x_1001 + x_1000 + x_1100 + x_1200 + x_2000 + x_2100 + x_3000 + x_3100 + x_4000 + x_5000 = 1,
l_1 = 24,
l_2 = 0.504,
l_3 = 0.144,
l_4 = 0.072,
m_1 = 0.167,
m_2 = 0.05,
m_3 = 0.05,
m_4 = 0.05
'''

conversion = {
    "2010": "0",
    "1010": "1",
    "0010": "2",
    "0110": "3",
    "0001": "4",
    "0000": "5",
    "0100": "6",
    "0200": "7",
    "1001": "8",
    "1000": "9",
    "1100": "10",
    "1200": "11",
    "2000": "12",
    "2100": "13",
    "3000": "14",
    "3100": "15",
    "4000": "16",
    "5000": "17",
}

reverse_conversion = {v: k for k, v in conversion.items()}

converted = just_eq
for key, value in conversion.items():
    converted = converted.replace(key, value)

print(converted)


replaced = '''
(2m_1 +m_3)x_0 =l_1x_1 + l_3x_12
(l_1 +m_1 +m_3)x_1 = 2m_1x_0 +l_1x_2 +m_3x_9
(l_1 +l_2 +m_3)x_2 =m_1x_1 +l_3x_5 +m_2x_3
(m_2 +m_3)x_3 =l_2x_2 +l_3x_6
(m_4 +l_1)x_4 =l_4x_5 +m_1x_8
(l_1 +l_2 +l_3 +l_4)x_5 =m_3x_2 +m_4x_4 +m_1x_9 +m_2x_6
(m_2 +l_1 +l_2 +l_3)x_6 =l_2x_5 +m_1x_10+2m_2x_7 +m_3x_3
(2m_2 +l_1)x_7 =l_2x_6 +m_1x_11
(m_1 +m_4)x_8 =l_1x_4 +l_4x_9
(l_4 +l_1 +l_2 +m_1 +l_3)x_9 =m_4x_8+2m_1x_12 +m_2x_10 +l_1x_5 +m_3x_1
(m_2 +l_1 +l_2 +m_1)x_10 =l_2x_9+2m_1x_13+2m_2x_11 +l_1x_6
(2m_2 +m_1)x_11 =l_2x_10 +l_1x_7
(l_3 +l_1 +l_2+2m_1)x_12 =m_3x_0+3m_1x_14 +m_2x_13 +l_1x_9
(m_2 +l_1+2m_1)x_13 =l_2x_12+3m_1x_15 +l_1x_10
(l_1 +l_2+3m_1)x_14 = 4m_1x_16 +m_2x_15 +l_1x_12
(m_2+3m_1)x_15 =l_2x_14 +l_1x_13
(l_1+4m_1)x_16 = 5m_1x_17 +l_1x_14
5m_1x_17 =l_1x_16
x_0 + x_1 + x_2 + x_3 + x_4 + x_5 + x_6 + x_7 + x_8 + x_9 + x_10 + x_11 + x_12 + x_13 + x_14 + x_15 + x_16 + x_17 = 1
'''

# Define the variables
x = symbols('x(0:18)')
print(x)

# Define the equations

equations = [
    Eq((2*m_1 + m_3)*x[0], l_1*x[1] + l_3*x[12]),
    # Eq((l_1 + m_1 + m_3)*x[1], 2*m_1*x[0] + l_1*x[2] + m_3*x[9]),
    Eq((l_1 + l_2 + m_3)*x[2], m_1*x[1] + l_3*x[5] + m_2*x[3]),
    Eq((m_2 + m_3)*x[3], l_2*x[2] + l_3*x[6]),
    Eq((m_4 + l_1)*x[4], l_4*x[5] + m_1*x[8]),
    Eq((l_1 + l_2 + l_3 + l_4)*x[5], m_3 *
       x[2] + m_4*x[4] + m_1*x[9] + m_2*x[6]),
    Eq((m_2 + l_1 + l_2 + l_3)*x[6], l_2 *
       x[5] + m_1*x[10]+2*m_2*x[7] + m_3*x[3]),
    Eq((2*m_2 + l_1)*x[7], l_2*x[6] + m_1*x[11]),
    Eq((m_1 + m_4)*x[8], l_1*x[4] + l_4*x[9]),
    Eq((l_4 + l_1 + l_2 + m_1 + l_3) *
       x[9], m_4*x[8]+2*m_1*x[12] + m_2*x[10] + l_1*x[5] + m_3*x[1]),
    Eq((m_2 + l_1 + l_2 + m_1)*x[10], l_2 *
       x[9]+2*m_1*x[13]+2*m_2*x[11] + l_1*x[6]),
    Eq((2*m_2 + m_1)*x[11], l_2*x[10] + l_1*x[7]),
    Eq((l_3 + l_1 + l_2+2*m_1)*x[12], m_3 *
       x[0]+3*m_1*x[14] + m_2*x[13] + l_1*x[9]),
    Eq((m_2 + l_1+2*m_1)*x[13], l_2*x[12]+3*m_1*x[15] + l_1*x[10]),
    Eq((l_1 + l_2+3*m_1)*x[14], 4*m_1*x[16] + m_2*x[15] + l_1*x[12]),
    Eq((m_2+3*m_1)*x[15], l_2*x[14] + l_1*x[13]),
    Eq((l_1+4*m_1)*x[16], 5*m_1*x[17] + l_1*x[14]),
    Eq(5*m_1*x[17], l_1*x[16]),
    Eq(x[0] + x[1] + x[2] + x[3] + x[4] + x[5] + x[6] + x[7] + x[8] + x[9] +
       x[10] + x[11] + x[12] + x[13] + x[14] + x[15] + x[16] + x[17], 1),
]


solutions = solve(equations, x)
print(solutions)

# Print the solutions
for i in range(len(solutions)):
    print(f"x{i} = {solutions[x[i]]}")

for i in range(len(solutions)):
    pi = ", ".join(list(map(str, reverse_conversion.get(str(i)))))
    printItem(f"\pi({pi}) = {solutions[x[i]]}")


res = '''
x1 = 0.0000525112788610273
x2 = 7.29848115657697E-7
x3 = 5.09143246994247E-9
x4 = 5.28717628488939E-8
x5 = 2.77846148488344E-9
x6 = 3.38062090060584E-9
x7 = 1.88964883335999E-8
x8 = 9.50996401948542E-8
x9 = 3.98674215608402E-7
x10 = 2.75405960414176E-7
x11 = 0.00000271166517225997
x12 = 0.0000136669311291967
x13 = 0.0000193288908802656
x14 = 0.000194838506845700
x15 = 0.000925942354561914
x16 = 0.00933357370416698
x17 = 0.0332673899842604
x18 = 0.956188454637424
'''

res_with_pi = '''
pi(2,0,1,0) = 0.0000525112788610273
pi(1,0,1,0) = 7.29848115657697E-7
pi(0,0,1,0) = 5.09143246994247E-9
pi(0,1,1,0) = 5.28717628488939E-8
pi(0,0,0,1) = 2.77846148488344E-9
pi(0,0,0,0) = 3.38062090060584E-9
pi(0,1,0,0) = 1.88964883335999E-8
pi(0,2,0,0) = 9.50996401948542E-8
pi(1,0,0,1) = 3.98674215608402E-7
pi(1,0,0,0) = 2.75405960414176E-7
pi(1,1,0,0) = 0.00000271166517225997
pi(1,2,0,0) = 0.0000136669311291967
pi(2,0,0,0) = 0.0000193288908802656
pi(2,1,0,0) = 0.000194838506845700
pi(3,0,0,0) = 0.000925942354561914
pi(3,1,0,0) = 0.00933357370416698
pi(4,0,0,0) = 0.0332673899842604
pi(5,0,0,0) = 0.956188454637424
'''

# OR with other coefficients

res_with_pi_2 = '''
pi(2, 0, 1, 0) = 0.0142466945224981
pi(1, 0, 1, 0) = 0.00472232021178464
pi(0, 0, 1, 0) = 0.000704605866919918
pi(0, 1, 1, 0) = 0.000455257661802284
pi(0, 0, 0, 1) = 0.000298700700552088
pi(0, 0, 0, 0) = 0.00308916741851143
pi(0, 1, 0, 0) = 0.00208645608380313
pi(0, 2, 0, 0) = 0.000729287867089777
pi(1, 0, 0, 1) = 0.00198929479542077
pi(1, 0, 0, 0) = 0.0197907875412172
pi(1, 1, 0, 0) = 0.0138873104194114
pi(1, 2, 0, 0) = 0.00486153040903532
pi(2, 0, 0, 0) = 0.0660803706839910
pi(2, 1, 0, 0) = 0.0462830178900077
pi(3, 0, 0, 0) = 0.146848828853475
pi(3, 1, 0, 0) = 0.102847590199856
pi(4, 0, 0, 0) = 0.244748048089125
pi(5, 0, 0, 0) = 0.326330730785500
'''
